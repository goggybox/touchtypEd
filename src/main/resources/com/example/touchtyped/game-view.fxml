<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.*?>

<BorderPane maxHeight="700.0"
            minHeight="300.0"
            minWidth="500.0"
            prefHeight="300.0"
            stylesheets="@game-view-style.css"
            xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.example.touchtyped.controller.GameViewController">

   <top>
      <HBox styleClass="nav-bar" BorderPane.alignment="CENTER">
         <children>
            <Region fx:id="leftSpacer" HBox.hgrow="ALWAYS" />
            <AnchorPane prefHeight="120.0" prefWidth="1200.0">
               <children>
                  <ImageView fitHeight="104.0" fitWidth="389.0" layoutY="8.0" pickOnBounds="true" preserveRatio="true">
                     <Image url="@images/logo.png" />
                  </ImageView>
                  <ImageView fx:id="learnButton"
                           fitHeight="69.0" fitWidth="175.0" 
                           layoutX="933.0" layoutY="26.0"
                           pickOnBounds="true" 
                           preserveRatio="true"
                           onMouseClicked="#onLearnButtonClick"
                           style="-fx-cursor: hand;">
                     <Image url="@images/nav-bar/learn.png" />
                  </ImageView>
                  <ImageView fx:id="gamesButton" 
                           fitHeight="69.0" fitWidth="71.0" 
                           layoutX="1022.0" layoutY="26.0" 
                           pickOnBounds="true" 
                           preserveRatio="true"
                           style="-fx-cursor: hand;">
                     <Image url="@images/nav-bar/gamesSelected.png" />
                  </ImageView>
                  <ImageView fx:id="optionsButton"
                           fitHeight="69.0" fitWidth="175.0" 
                           layoutX="1111.0" layoutY="26.0" 
                           pickOnBounds="true" 
                           preserveRatio="true">
                     <Image url="@images/nav-bar/options.png" />
                  </ImageView>
               </children>
            </AnchorPane>
            <Region fx:id="rightSpacer" HBox.hgrow="ALWAYS" />
         </children>
      </HBox>
   </top>

   <center>
      <VBox fx:id="gameContainer" alignment="TOP_CENTER" spacing="20" styleClass="game-container"
            prefHeight="580">

          <fx:define>
              <ToggleGroup fx:id="modeToggleGroup"/>
          </fx:define>

         <Region VBox.vgrow="ALWAYS" styleClass="large-region"/>

          <HBox alignment="CENTER" spacing="15" styleClass="time-options">
              <Label text="Mode:" styleClass="time-label"/>
              <RadioButton fx:id="timedModeRadio"
                           text="Timed Mode"
                           toggleGroup="${modeToggleGroup}"
                           selected="true"/>

              <RadioButton fx:id="articleModeRadio"
                           text="Article Mode"
                           toggleGroup="${modeToggleGroup}"/>
          </HBox>

          <HBox fx:id="timeBox"
          alignment="CENTER" spacing="15" styleClass="time-options">
          <Label text="Time:" styleClass="time-label"/>
          <Button fx:id="time15Button" text="15s" onAction="#select15s" styleClass="time-button"/>
          <Button fx:id="time30Button" text="30s" onAction="#select30s" styleClass="time-button"/>
          <Button fx:id="time60Button" text="60s" onAction="#select60s" styleClass="time-button"/>
          <Button fx:id="time120Button" text="120s" onAction="#select120s" styleClass="time-button"/>
      </HBox>

          <HBox alignment="CENTER" spacing="30" styleClass="game-info">
              <!-- Existing timer label -->
              <Label fx:id="timerLabel" text="60"/>

              <!-- New labels for real-time stats -->
              <Label fx:id="wpmLabel" text="WPM: 0" />
              <Label fx:id="accuracyLabel" text="Accuracy: 0%" />
          </HBox>

         <VBox alignment="CENTER" styleClass="typing-area">
            <StackPane minWidth="500"
                       minHeight="200"
                       VBox.vgrow="ALWAYS">
                <TextFlow fx:id="taskLabel" styleClass="task-text"/>
                <Text fx:id="cursorLabel" styleClass="cursor" visible="false">â”‚</Text>
            </StackPane>
            <TextField fx:id="inputField" styleClass="input-field"/>
         </VBox>

         <Region VBox.vgrow="ALWAYS" styleClass="large-region"/>

         <HBox alignment="CENTER" spacing="20">
            <Button fx:id="returnButton" 
                    onAction="#resetGame"
                    styleClass="control-button"
                    focusTraversable="false">
                <graphic>
                    <ImageView fitHeight="24" fitWidth="24">
                        <Image url="@images/game-content/return.png"/>
                    </ImageView>
                </graphic>
            </Button>
         </HBox>

         <VBox fx:id="resultContainer" alignment="CENTER" spacing="20" visible="false">
            <HBox alignment="CENTER" spacing="30" styleClass="result-info">
                <VBox alignment="CENTER" styleClass="result-item">
                    <Label text="wpm" styleClass="result-label"/>
                    <Label fx:id="finalWpmLabel" styleClass="result-value"/>
                </VBox>
                <VBox alignment="CENTER" styleClass="result-item">
                    <Label text="acc" styleClass="result-label"/>
                    <Label fx:id="finalAccLabel" styleClass="result-value"/>
                </VBox>
                <VBox alignment="CENTER" styleClass="result-item">
                    <Label text="char" styleClass="result-label"/>
                    <Label fx:id="finalCharLabel" styleClass="result-value"/>
                </VBox>
            </HBox>

            <HBox alignment="CENTER" spacing="20" styleClass="result-buttons">
                <Button fx:id="restartButton" 
                        onAction="#resetGame" 
                        styleClass="result-button"
                        focusTraversable="false">
                    <graphic>
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@images/game-content/return.png"/>
                        </ImageView>
                    </graphic>
                    <tooltip>
                        <Tooltip text="restart"/>
                    </tooltip>
                </Button>
            </HBox>
         </VBox>
      </VBox>
   </center>

</BorderPane> 