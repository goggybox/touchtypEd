<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.*?>

<?import javafx.geometry.Insets?>
<BorderPane maxHeight="20000.0"
            minHeight="300.0"
            minWidth="500.0"
            stylesheets="@game-view-style.css"
            xmlns="http://javafx.com/javafx/17.0.2-ea"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.touchtyped.controller.GameViewController">

    <top>
        <HBox styleClass="nav-bar" BorderPane.alignment="CENTER">
            <children>
                <Region fx:id="leftSpacer" HBox.hgrow="ALWAYS" />
                <AnchorPane prefHeight="120.0" prefWidth="1200.0">
                    <children>
                        <!-- Logo -->
                        <ImageView fitHeight="104.0" fitWidth="389.0" layoutY="8.0"
                                   pickOnBounds="true" preserveRatio="true">
                            <Image url="@images/logo.png" />
                        </ImageView>

                        <!-- Learn Button -->
                        <ImageView fx:id="learnButton"
                                   fitHeight="69.0" fitWidth="175.0"
                                   layoutX="933.0" layoutY="26.0"
                                   pickOnBounds="true"
                                   preserveRatio="true"
                                   onMouseClicked="#onLearnButtonClick"
                                   style="-fx-cursor: hand;">
                            <Image url="@images/nav-bar/learn.png" />
                        </ImageView>

                        <!-- Games Button (Current) -->
                        <ImageView fx:id="gamesButton"
                                   fitHeight="69.0" fitWidth="71.0"
                                   layoutX="1022.0" layoutY="26.0"
                                   pickOnBounds="true"
                                   preserveRatio="true"
                                   style="-fx-cursor: hand;">
                            <Image url="@images/nav-bar/gamesSelected.png" />
                        </ImageView>

                        <!-- Options Button -->
                        <ImageView fx:id="optionsButton"
                                   fitHeight="69.0" fitWidth="175.0"
                                   layoutX="1111.0" layoutY="26.0"
                                   pickOnBounds="true"
                                   preserveRatio="true">
                            <Image url="@images/nav-bar/options.png" />
                        </ImageView>
                    </children>
                </AnchorPane>
                <Region fx:id="rightSpacer" HBox.hgrow="ALWAYS" />
            </children>
        </HBox>
    </top>

    <!-- ======================= Main Content ======================= -->
    <center>
        <StackPane>
            <VBox fx:id="gameContainer"
                  alignment="TOP_CENTER"
                  spacing="20"
                  styleClass="game-container">

                <!-- Define mode switching ToggleGroup -->
                <fx:define>
                    <ToggleGroup fx:id="modeToggleGroup"/>
                </fx:define>

                <!-- Mode selection: Timed / Article / Competition -->
                <HBox alignment="CENTER" spacing="15" styleClass="time-options">
                    <Label text="Mode:" styleClass="time-label"/>
                    <RadioButton fx:id="timedModeRadio"
                                text="Timed Mode"
                                toggleGroup="${modeToggleGroup}"
                                selected="true"/>

                    <RadioButton fx:id="articleModeRadio"
                                text="Article Mode"
                                toggleGroup="${modeToggleGroup}"/>

                    <RadioButton fx:id="competitionModeRadio"
                                text="Competition Mode"
                                toggleGroup="${modeToggleGroup}"/>
                </HBox>

                <!--  Competition -->
                <VBox fx:id="competitionContainer"
                    spacing="10"
                    visible="false"
                    managed="false"
                    alignment="CENTER">

                    <Button text="Competition Mode Instructions"
                            onAction="#onCompetitionHelpButtonClick"
                            style="-fx-font-size: 14; -fx-cursor: hand;" />

                    <Button fx:id="onlineMatchButton"
                            text="Online Match"
                            style="-fx-cursor: hand;" />

                    <!-- Time left -->
                    <HBox alignment="CENTER" spacing="30">
                        <Label fx:id="compTimerLabel"
                            text="Time Left: 60"
                            styleClass="stats-label" />
                    </HBox>
                    <HBox alignment="CENTER" spacing="50">
                        <VBox fx:id="leftContainer" alignment="CENTER" spacing="10">
                            <Label fx:id="leftScoreLabel"
                                text="PlayerA Score: 0"
                                styleClass="stats-label" />
                            <TextFlow fx:id="leftTextFlow"
                                    textAlignment="CENTER"
                                    styleClass="task-text" />
                            <Text fx:id="leftCursor"
                                text="|"
                                styleClass="cursor"
                                visible="false"/>
                        </VBox>

                        <VBox fx:id="rightContainer" alignment="CENTER" spacing="10">
                            <Label fx:id="rightScoreLabel"
                                text="PlayerB Score: 0"
                                styleClass="stats-label" />
                            <TextFlow fx:id="rightTextFlow"
                                    textAlignment="CENTER"
                                    styleClass="task-text" />
                            <Text fx:id="rightCursor"
                                text="|"
                                styleClass="cursor"
                                visible="false"/>
                        </VBox>
                    </HBox>
                </VBox>


                <HBox fx:id="timeBox"
                    alignment="CENTER" spacing="15" styleClass="time-options">
                    <Label text="Time:" styleClass="time-label"/>
                    <Button fx:id="time15Button" text="15s" onAction="#select15s" styleClass="time-button"/>
                    <Button fx:id="time30Button" text="30s" onAction="#select30s" styleClass="time-button"/>
                    <Button fx:id="time60Button" text="60s" onAction="#select60s" styleClass="time-button"/>
                    <Button fx:id="time120Button" text="120s" onAction="#select120s" styleClass="time-button"/>
                </HBox>

                <HBox alignment="CENTER" spacing="30" styleClass="game-info">
                    <Label fx:id="timerLabel" text="60"/>
                    <Label fx:id="wpmLabel" text="WPM: 0" />
                    <Label fx:id="accuracyLabel" text="Accuracy: 0%" />
                </HBox>

                <VBox alignment="CENTER" styleClass="typing-area">
                    <StackPane minWidth="500" minHeight="100" VBox.vgrow="ALWAYS">
                        <TextFlow fx:id="taskLabel"
                                textAlignment="CENTER"
                                styleClass="task-text" />
                        <Text fx:id="cursorLabel" styleClass="cursor" visible="false">|</Text>

                        <Label fx:id="comboLabel"
                            text=""
                            visible="false"
                            style="-fx-font-size: 40; -fx-text-fill: gold; -fx-font-weight: bold;
                -fx-effect: dropshadow(gaussian, black, 5, 0.5, 0, 0);"
                            StackPane.alignment="TOP_CENTER">
                            <StackPane.margin>
                                <Insets top="55.0" />
                            </StackPane.margin>
                        </Label>
                    </StackPane>

                    <TextField fx:id="inputField" styleClass="input-field"/>
                </VBox>

                <HBox alignment="CENTER" spacing="20">
                    <Button fx:id="returnButton"
                            onAction="#resetGame"
                            styleClass="control-button"
                            focusTraversable="false">
                        <graphic>
                            <ImageView fitHeight="24" fitWidth="24">
                                <Image url="@images/game-content/return.png"/>
                            </ImageView>
                        </graphic>
                    </Button>
                </HBox>

                <VBox fx:id="resultContainer" alignment="CENTER" spacing="20"
                    visible="false">
                    <HBox alignment="CENTER" spacing="30" styleClass="result-info">
                        <VBox alignment="CENTER" styleClass="result-item">
                            <Label text="wpm" styleClass="result-label"/>
                            <Label fx:id="finalWpmLabel" styleClass="result-value"/>
                        </VBox>
                        <VBox alignment="CENTER" styleClass="result-item">
                            <Label text="acc" styleClass="result-label"/>
                            <Label fx:id="finalAccLabel" styleClass="result-value"/>
                        </VBox>
                        <VBox alignment="CENTER" styleClass="result-item">
                            <Label text="char" styleClass="result-label"/>
                            <Label fx:id="finalCharLabel" styleClass="result-value"/>
                        </VBox>
                    </HBox>

                    <HBox alignment="CENTER" spacing="20" styleClass="result-buttons">
                        <Button fx:id="restartButton"
                                onAction="#resetGame"
                                styleClass="result-button"
                                focusTraversable="false">
                            <graphic>
                                <ImageView fitHeight="24" fitWidth="24">
                                    <Image url="@images/game-content/return.png"/>
                                </ImageView>
                            </graphic>
                            <tooltip>
                                <Tooltip text="restart"/>
                            </tooltip>
                        </Button>
                    </HBox>
                </VBox>
            </VBox>
            
            <!-- Information button - placed at the bottom right corner of the window -->
            <Button fx:id="timedModeInfoButton"
                    text="i"
                    onAction="#showTimedModeInfo"
                    focusTraversable="false"
                    styleClass="info-button"
                    StackPane.alignment="BOTTOM_RIGHT">
                <StackPane.margin>
                    <Insets bottom="20.0" right="20.0" />
                </StackPane.margin>
            </Button>
        </StackPane>
    </center>

</BorderPane>
